import json
import sys
from pathlib import Path

REPO_ROOT = Path(__file__).resolve().parents[1]
if str(REPO_ROOT) not in sys.path:
    sys.path.insert(0, str(REPO_ROOT))

from src.adapters.sentiment_classifier import _build_prompt, classify_sentiment

NEGATIVE_SAMPLE = """西安交大纪委：已查处多起涉教职工案件
《中国纪检监察报》10月18日报道，作风建设是一场持久战。必须以永远在路上的清醒与执着，常抓不懈、严抓不怠。

文章披露，一些地方通过织密织牢全方位、多层次的监督网络，凝聚纠治“四风”的合力，有效提高监督穿透力和有效性。

西安交通大学纪委、监察专员办制定《教职工违规违纪违法问题调查处置规程》，对医疗腐败、师德师风等需要长期纠治的问题盯住不放、寸步不让，明确责任单位，压实责任链条。

“自文件出台以来，学校已多部门协同查处多起案件，查处个别教师在校外投标活动中串通投标问题，给予党内警告处分2人；查出个别教师套取科研经费问题，给予党内警告处分2人，诫勉谈话5人，批评教育7人。”西安交大纪委、监察专员办有关负责同志介绍。

西安交通大学是教育部直属重点大学，首批进入国家“211”和“985”工程建设学校。

“政事儿”注意到，《党风廉政建设》杂志2025年第5期刊发西安交通大学党委副书记、纪委书记，国家监委驻西安交通大学监察专员马博虎署名文章《“五个坚持”打造纪检监察铁军》。

文章称，西安交通大学纪检监察机构聚焦提升依规依纪依法办案质效、加强纪检监察队伍建设、加强纪法教育和培训，以“五个坚持”为抓手，深入贯彻落实“三化”建设年行动要求，打造新时代纪检监察铁军，持续推进学校纪检监察工作高质量发展。

其中，聚焦监督工作，依据学校纪委制定的《关于推动政治监督具体化精准化常态化的若干举措》《二级单位纪检工作日常监督工作清单》，构建起全方位、多层次的监督网络，实现对招生考试、基建后勤、招标采购、资产管理、校办企业、科研经费、附属医院等重点领域的全过程监督。聚焦执纪执法工作，持续完善信访举报、线索处置、初步核实、审查调查、案件审理、处分执行等制度，并规范各环节文书模板。聚焦构建完善监督体系，制定《教职工违规违纪违法问题调查处置规程》，完善协同机制，督促各职能部门认真履行监管责任，强化线索移交、信息沟通、工作统筹。
"""

if __name__ == "__main__":
    prompt = _build_prompt(NEGATIVE_SAMPLE)
    print("=== Prompt Content ===")
    print(prompt["content"])
    print("\n=== Sentiment API Response ===")
    result = classify_sentiment(NEGATIVE_SAMPLE)
    print(json.dumps(result, ensure_ascii=False, indent=2))
