# 教育资讯自动化管线（非技术版简介）

本文面向业务/运营同事，介绍我们目前的“教育资讯简报”自动化流程：它从公开新闻源抓取教育相关内容，自动生成摘要并给出相关度评分，最终产出一份可阅读、可转发的文字简报（并在需要时推送到飞书）。

## 我们在做什么

- 目标：帮团队高效追踪“教育领域”动态，节省人工搜集与整理时间。
- 产出：一份日常可用的“教育资讯简报”文本文件，必要时通过飞书消息发送并附上完整文件。
- 数据来源：
  - 今日头条（指定作者列表）
  - 中国新闻网（按频道滚动抓取）

## 流程怎么跑

整条管线分为四步，按顺序自动执行（其中“导出”通常在每日固定时间或按需触发）：

1) 抓取（Crawl）
- 从配置的新闻源获取最新文章，保存基础信息与正文。
- 基于关键词做初筛，符合条件的候选会进入“待摘要”队列。

2) 摘要（Summarize）
- 调用大语言模型（LLM）为候选文章生成简洁摘要（中文）。
- 失败项会自动重试，确保尽可能补齐。

3) 评分（Score）
- 使用模型为每条摘要打“与教育相关度”分（0–100）。
- 后续导出会优先选择高分内容。

4) 导出（Export）
- 汇总高分摘要，按固定模板生成“教育资讯简报”（.txt）。
- 可记录导出批次，便于追踪历史；如配置飞书，将同步发送简要预览与完整附件。

说明：
- 常规“小时级”任务包含步骤：抓取 → 摘要 → 评分，用于不断刷新素材池。
- “每日导出”或“按需导出”会在以上基础上额外执行导出步骤，生成对外发布的简报。

## 运行频率与时长

- 小时任务：每小时跑一次抓取/摘要/评分，避免重叠执行（有锁机制保护）。
- 每日导出：建议工作日固定时段执行（也可手动触发）。
- 时长示例：一次完整“抓取→摘要→评分”耗时约 7–10 分钟（以当天量级与网络/模型响应为准）。

## 我们产出到哪里

- 简报文件：默认写入 `outputs/` 目录，命名包含日期/标签，避免覆盖历史文件。
- 飞书通知（如开启）：
  - 文本消息包含条目数与部分预览；
  - 完整 `.txt` 简报作为附件发送到指定群或个人。

## 如何看运行是否正常

- 日志位置：`logs/` 目录，按时间自动命名，例如：
  - `logs/pipeline_hourly_YYYYMMDD_HHMMSS.log`
- 日志内容要点：
  - 每一步都会有开始/结束与“ok/failed”计数；
  - 末尾会显示本次运行的 `run_id`、开始/结束时间与各步骤用时；
  - 示例：抓取 upsert 数、需要补正文的数量、成功摘要条数、评分分布等。
- Web 看板（如部署）：访问 `/dashboard` 可查看最近运行快照与最新一次导出简要信息（需要登录）。

## 失败了怎么办

- 大多数短暂性失败（网络、反爬、模型超时）会被自动重试或下次周期性任务弥补。
- 如果连续多次失败或明显“量级异常”（如抓取/摘要条数突然为 0），建议：
  - 先看 `logs/` 中最新日志；
  - 联系技术同事协助定位（提供日志文件名与 `run_id` 更快排查）。

## 数据与合规

- 仅抓取公开新闻内容，不涉及敏感个人信息；
- 摘要与评分调用的模型服务经过密钥授权（仅用于本项目用途）。

## FAQ（常见问题）

- 为什么看到“评分很低”的条目？
  - 评分只是“与教育主题相关度”的参考，低分内容一般不会进入最终简报。
- 可以临时“只导出”吗？
  - 可以。即便未到每日定时，也可按需触发导出从当前素材池产出最新简报。
- 能否加新的信息源？
  - 支持扩展，技术同事可在不影响现有流程的情况下新增来源或调整关键词。

——
如需对外分享，请直接转发生成的 `.txt` 简报或飞书消息；如需定制版式/模板，请与我们沟通需求即可。

